!function(){"function"==typeof require&&(window.$=require("./zadark-jquery.min.js"),window.hotkeys=require("./zadark-hotkeys-js.min.js"),window.Toastify=require("./zadark-toastify.min.js"),window.WebFont=require("./zadark-webfont.min.js"),window.introJs=require("./zadark-introjs.min.js"),window.localforage=require("./zadark-localforage.min.js"));const t={block_typing:"@ZaDark:ENABLED_BLOCK_TYPING",block_delivered:"@ZaDark:ENABLED_BLOCK_DELIVERED",block_seen:"@ZaDark:ENABLED_BLOCK_SEEN"},a=["block_typing","block_delivered","block_seen","block_online"],e={fontSize:{small:"Đã áp dụng cỡ chữ 90%",medium:"Đã áp dụng cỡ chữ 100%",big:"Đã áp dụng cỡ chữ 110%","very-big":"Đã áp dụng cỡ chữ 125%"},hideLatestMessage:{true:"Đã bật Ẩn Tin nhắn gần nhất",false:"Đã tắt Ẩn Tin nhắn gần nhất"},hideThreadChatMessage:{true:"Đã bật Ẩn Tin nhắn trong cuộc trò chuyện",false:"Đã tắt Ẩn Tin nhắn trong cuộc trò chuyện"},hideConvAvatar:{true:"Đã bật Ẩn Ảnh đại diện",false:"Đã tắt Ẩn Ảnh đại diện"},hideConvName:{true:"Đã bật Ẩn Tên cuộc trò chuyện",false:"Đã tắt Ẩn Tên cuộc trò chuyện"},block_typing:{true:"Đã bật Ẩn trạng thái Đang soạn tin",false:"Đã tắt Ẩn trạng thái Đang soạn tin"},block_delivered:{true:"Đã bật Ẩn trạng thái Đã nhận",false:"Đã tắt Ẩn trạng thái Đã nhận"},block_seen:{true:"Đã bật Ẩn trạng thái Đã xem",false:"Đã tắt Ẩn trạng thái Đã xem"},useHotkeys:{true:"Đã kích hoạt phím tắt",false:"Đã vô hiệu hoá phím tắt"}},n="Bạn vui lòng tắt & mở lại Zalo PC để áp dụng thay đổi",s=window.localforage.createInstance({name:"zadark"}),i=()=>!(!window.$zelectron||"function"!=typeof window.$zelectron.setCookie)||!(!window.electronAPI||"function"!=typeof window.electronAPI.setCustomCookie),o=async(t,a)=>{try{const e="https://zadark.com/",n="zadark.com";return window.$zelectron&&"function"==typeof window.$zelectron.setCookie?(await window.$zelectron.setCookie(t,a,e,n),!0):!(!window.electronAPI||"function"!=typeof window.electronAPI.setCustomCookie)&&(await window.electronAPI.setCustomCookie(e,n,{name:t,value:a,expirationDate:Date.now()+31536e6}),!0)}catch(t){return!1}},c={getTheme:()=>localStorage.getItem("@ZaDark:THEME")||"dark",saveTheme:t=>localStorage.setItem("@ZaDark:THEME",t),getFontFamily:()=>{const t=localStorage.getItem("@ZaDark:FONT_FAMILY");return null===t?"Open Sans":t},saveFontFamily:t=>localStorage.setItem("@ZaDark:FONT_FAMILY",t),getFontSize:()=>localStorage.getItem("@ZaDark:FONT_SIZE")||"medium",saveFontSize:t=>localStorage.setItem("@ZaDark:FONT_SIZE",t),saveTranslateTarget:t=>localStorage.setItem("@ZaDark:TRANSLATE_TARGET",t),getTranslateTarget:()=>localStorage.getItem("@ZaDark:TRANSLATE_TARGET")||"vi",saveThreadChatBg:(t,a)=>a?s.setItem(t,a):s.removeItem(t),getThreadChatBg:t=>s.getItem(t),saveEnabledHideLatestMessage:t=>localStorage.setItem("@ZaDark:ENABLED_HIDE_LATEST_MESSAGE",t),getEnabledHideLatestMessage:()=>"true"===localStorage.getItem("@ZaDark:ENABLED_HIDE_LATEST_MESSAGE"),saveEnabledHideConvAvatar:t=>localStorage.setItem("@ZaDark:ENABLED_HIDE_CONV_AVATAR",t),getEnabledHideConvAvatar:()=>"true"===localStorage.getItem("@ZaDark:ENABLED_HIDE_CONV_AVATAR"),saveEnabledHideConvName:t=>localStorage.setItem("@ZaDark:ENABLED_HIDE_CONV_NAME",t),getEnabledHideConvName:()=>"true"===localStorage.getItem("@ZaDark:ENABLED_HIDE_CONV_NAME"),saveEnabledHideThreadChatMessage:t=>localStorage.setItem("@ZaDark:ENABLED_HIDE_THREAD_CHAT_MESSAGE",t),getEnabledHideThreadChatMessage:()=>"true"===localStorage.getItem("@ZaDark:ENABLED_HIDE_THREAD_CHAT_MESSAGE"),saveBlockSettings:(a,e)=>{const n=t[a];if(n)return o(n,e?"true":"false"),localStorage.setItem(n,e)},getBlockSettings:()=>({block_typing:"true"===localStorage.getItem("@ZaDark:ENABLED_BLOCK_TYPING"),block_delivered:"true"===localStorage.getItem("@ZaDark:ENABLED_BLOCK_DELIVERED"),block_seen:"true"===localStorage.getItem("@ZaDark:ENABLED_BLOCK_SEEN")}),saveUseHotkeys:t=>localStorage.setItem("@ZaDark:USE_HOTKEYS",t),getUseHotkeys:()=>{return"true"===(localStorage.getItem("@ZaDark:USE_HOTKEYS")||"true")},getKnownVersion:()=>localStorage.getItem("@ZaDark:KNOWN_VERSION")||"0.0",saveKnownVersion:t=>localStorage.setItem("@ZaDark:KNOWN_VERSION",t),getZaloAppVersion:()=>localStorage.getItem("sh_app_ver")||"0.0",isMigrationNeeded:()=>"m+Jd9BU7kPe66ysM"!==localStorage.getItem("@ZaDark:MIGRATION"),setMigrationDone:()=>localStorage.setItem("@ZaDark:MIGRATION","m+Jd9BU7kPe66ysM")},r={getZaDarkVersion:()=>$("html").data("zadark-version"),getCurrentConvId:()=>document.body.getAttribute("data-current-conv-id"),toggleBodyClassName:(t,a)=>{a?document.body.classList.add(t):document.body.classList.remove(t)},isMac:()=>"macOS"===document.documentElement.getAttribute("data-zadark-os"),setThemeAttr:t=>{document.documentElement.setAttribute("data-zadark-theme",t)},setFontFamilyAttr:t=>{if(!t)return document.querySelector(":root").style.removeProperty("--zadark-font-family"),void document.documentElement.removeAttribute("data-zadark-use-font");document.querySelector(":root").style.setProperty("--zadark-font-family",t),document.documentElement.setAttribute("data-zadark-use-font","true")},setFontSizeAttr:t=>{document.documentElement.setAttribute("data-zadark-font-size",t)},setHideLatestMessageAttr:function(t){this.toggleBodyClassName("zadark-prv--latest-message",t)},setHideConvAvatarAttr:function(t){this.toggleBodyClassName("zadark-prv--conv-avatar",t)},setHideConvNameAttr:function(t){this.toggleBodyClassName("zadark-prv--conv-name",t)},setHideThreadChatMessageAttr:function(t){this.toggleBodyClassName("zadark-prv--thread-chat-message",t)},setUseHotkeysAttr:function(t){this.toggleBodyClassName("zadark--use-hotkeys",t)},setPageTheme:function(t){switch(t){case"light":case"dark":return void this.setThemeAttr(t);case"auto":{const t=window.matchMedia("(prefers-color-scheme: dark)").matches;return void this.setThemeAttr(t?"dark":"light")}default:this.setThemeAttr("dark")}},initBlockSettings:function(){const t=c.getBlockSettings(),e=[],n=[];a.forEach(a=>{t[a]?e.push(a):n.push(a)})},getRatingURL:function(){return"https://sourceforge.net/projects/zadark/reviews/new?stars=5"},showToast:function(t,a={}){const e=Toastify({text:t,duration:1408,gravity:"bottom",position:"center",escapeMarkup:!1,offset:{x:15,y:15},...a,onClick:function(){e.hideToast()}});return e.showToast(),e},showIntro:({steps:t=[],onExit:a,onComplete:e}={})=>{const n=introJs().setOptions({steps:t,disableInteraction:!1,prevLabel:"Trước",nextLabel:"Tiếp",doneLabel:"Đã hiểu",helperElementPadding:-4});"function"==typeof a&&n.onexit(a),"function"==typeof e&&n.oncomplete(e),n.start()},setSelect:(t,a)=>{$(t).val(a)},setSwitch:(t,a)=>{$(t).prop("checked",a)},installFontFamily:(t=[],a=!0)=>t.length?new Promise(e=>{WebFont.load({google:{families:t},loading:()=>{console.log("Fonts are being loaded",t)},active:()=>{console.log("Fonts have been rendered",t),e(!0)},inactive:()=>{console.log("Fonts failed to load",t),e(!1)},classes:a,timeout:1408})}):Promise.resolve(!1),initFontFamily:async function(){const t=c.getFontFamily();t?(await this.installFontFamily([`${t}:400,500,600:latin,vietnamese`,"Open Sans:400,500,600:latin,vietnamese"],!1),this.setFontFamilyAttr(t)):this.installFontFamily(["Open Sans:400,500,600:latin,vietnamese"],!1)},initPageSettings:async function(){this.initFontFamily(),this.initBlockSettings();const t=c.getTheme();this.setPageTheme(t);const a=c.getFontSize();this.setFontSizeAttr(a);const e=c.getEnabledHideLatestMessage();this.setHideLatestMessageAttr(e);const n=c.getEnabledHideConvAvatar();this.setHideConvAvatarAttr(n);const s=c.getEnabledHideConvName();this.setHideConvNameAttr(s);const i=c.getEnabledHideThreadChatMessage();this.setHideThreadChatMessageAttr(i);const o=c.getUseHotkeys();this.setUseHotkeysAttr(o)},updateTheme:function(t){c.saveTheme(t),this.setPageTheme(t)},updateFontFamily:async function(t){if(!t)return c.saveFontFamily(""),this.setFontFamilyAttr(""),this.showToast("Đã thay đổi phông chữ"),!0;const a=this.showToast("Đang tải phông chữ...",{duration:-1}),e=await this.installFontFamily([`${t}:400,500:latin,vietnamese`],!1);return a.hideToast(),e?(c.saveFontFamily(t),this.setFontFamilyAttr(t),this.showToast("Đã thay đổi phông chữ."),!0):(this.showToast("Không thể tải phông chữ."),!1)},updateFontSize:function(t){c.saveFontSize(t),this.setFontSizeAttr(t),r.showToast(e.fontSize[t])},updateTranslateTarget:function(t){c.saveTranslateTarget(t)},getThreadChatBgSettingKey:function(){const t=this.getCurrentConvId();return t?`THREAD_CHAT_BG_${t}`:null},updateThreadChatBg:async function(t){const a=this.getThreadChatBgSettingKey();if(!a)throw new Error("Bạn cần chọn một cuộc trò chuyện");await c.saveThreadChatBg(a,t),this.refreshThreadChatBg(t),r.showToast(t?"Đã thay đổi hình nền":"Đã xóa hình nền")},updateHideLatestMessage:function(t){c.saveEnabledHideLatestMessage(t),this.toggleBodyClassName("zadark-prv--latest-message",t),this.showToast(e.hideLatestMessage[t])},updateHideConvAvatar:function(t){c.saveEnabledHideConvAvatar(t),this.toggleBodyClassName("zadark-prv--conv-avatar",t),this.showToast(e.hideConvAvatar[t])},updateHideConvName:function(t){c.saveEnabledHideConvName(t),this.toggleBodyClassName("zadark-prv--conv-name",t),this.showToast(e.hideConvName[t])},updateHideThreadChatMessage:function(t){c.saveEnabledHideThreadChatMessage(t),this.toggleBodyClassName("zadark-prv--thread-chat-message",t),this.showToast(e.hideThreadChatMessage[t])},updateBlockSettings:function(t,a){c.saveBlockSettings(t,a),this.showToast(e[t][a]),this.showToast(n,{className:"toastify--warning",duration:1e4})},updateUseHotkeys:function(t){c.saveUseHotkeys(t),this.showToast(e.useHotkeys[t]),this.setUseHotkeysAttr(t)},updateKnownVersionState:t=>{const a=$("html").data("zadark-version");c.saveKnownVersion(a),t.classList.remove("zadark-known-version")},showIntroHideThreadChatMessage:function({onExit:t,onComplete:a}={}){this.showIntro({steps:[{element:document.querySelector("#messageView"),intro:"Bạn di chuột vào vùng này để <strong>xem nội dung tin nhắn</strong>"},{element:document.querySelector("#chatInput"),intro:"Bạn di chuyển chuột vào vùng này để <strong>xem nội dung khung soạn tin nhắn</strong>"},{element:document.querySelector(".chat-box-bar"),intro:"Bạn di chuyển chuột vào vùng này để: <strong>Ẩn nội dung tin nhắn</strong> (bên trên), <strong>Ẩn nội dung khung soạn tin nhắn</strong> (bên dưới)"}],onExit:t,onComplete:a})},refreshThreadChatBg:t=>{const a=r.getCurrentConvId(),e=r.getThreadChatBgSettingKey();let n=document.getElementById(e);if(!t){if(!n)return;n.remove();const t=n.getAttribute("data-blob-url");return void URL.revokeObjectURL(t)}const s=URL.createObjectURL(t),i=`body[data-current-conv-id="${a}"] { --zadark-thread-chat-bg-url: url('${s}'); }`;n?n.innerHTML=i:((n=document.createElement("style")).type="text/css",n.id=e,n.setAttribute("data-blob-url",s),n.appendChild(document.createTextNode(i)),document.head.appendChild(n))},migrateData:async function(){c.isMigrationNeeded()&&(localStorage.removeItem("@ZaDark:THREAD_CHAT_BG_KEY"),c.setMigrationDone(),this.showToast("ZaDark đã hoàn tất khởi tạo dữ liệu. Bạn vui lòng tắt & mở lại Zalo PC.",{className:"toastify--warning",duration:1e4}))}};r.initPageSettings(),window.matchMedia("(prefers-color-scheme: dark)").addListener(t=>{"auto"===c.getTheme()&&r.setThemeAttr(t.matches?"dark":"light")});const l="#js-switch-block-typing",d="#js-switch-block-seen",h="#js-switch-block-delivered",g=i(),p=t=>{["light","dark","auto"].forEach(a=>{$('#js-radio-input-theme input:radio[name="theme"]').filter(`[value="${a}"]`).prop("checked",a===t)})};async function k(t){if(!(Number(t.keyCode?t.keyCode:t.which)-1==12))return;const a=$(this).val();await r.updateFontFamily(a)||$(this).val("")}const u=t=>{const a=c.getFontSize(),e=["small","medium","big","very-big"],n=t>0?Math.min(e.indexOf(a)+1,e.length-1):Math.max(e.indexOf(a)-1,0),s=e[n];r.setSelect("#js-select-font-size",s),r.updateFontSize(s)},m=t=>(function(a){if(!g)return r.setSwitch(this,!1),void r.showToast(`Vì Zalo nâng cấp mã nguồn, nên chức năng này tạm thời không khả dụng trên <strong>Zalo PC ${c.getZaloAppVersion()}</strong>.<br/>ZaDark sẽ cập nhật trong thời gian tới.`,{className:"toastify--error"});const e=$(this).is(":checked");r.updateBlockSettings(t,e)});const v=`\n    <div id="js-zadark-popup" class="zadark-popper">\n      <div id="zadark-popup">\n        <div id="js-zadark-popup__scrollable" class="zadark-popup__scrollable">\n          ${`\n    <div class="zadark-popup__header">\n      <div class="zadark-popup__header__logo">\n        <img src="zadark-lockup.svg" alt="ZaDark" class="zadark-popup__header__logo-img" />\n      </div>\n\n      <div class="zadark-popup__header__menu-list">\n        <span class="zadark-popup__header__menu-item zadark-popup__header__menu-divider">\n          <a href="https://www.producthunt.com/products/zadark-zalo-dark-mode#zadark-zalo-dark-mode" title="Product Hunt" target="_blank">Product Hunt</a>\n        </span>\n\n        <span class="zadark-popup__header__menu-item zadark-popup__header__menu-divider">\n          <a href="https://zadark.com/blog" title="Blog" target="_blank">Blog</a>\n        </span>\n\n        <span class="zadark-popup__header__menu-item zadark-popup__header__menu-divider">\n          <a href="${r.getRatingURL()}" title="Đánh giá" target="_blank">Đánh giá</a>\n        </span>\n\n        <span class="zadark-popup__header__menu-item">\n          <a href="https://zadark.canny.io" title="Góp ý" target="_blank">Góp ý</a>\n        </span>\n      </div>\n    </div>\n  `}\n          \n    <div class="zadark-popup__main">\n      <div class="zadark-panel">\n        <div class="zadark-panel__body">\n          <div id="js-radio-input-theme" class="zadark-radio__list zadark-radio__list--row">\n            <label class="zadark-radio">\n              <input type="radio" name="theme" value="light" class="zadark-radio__input">\n              <span class="zadark-radio__checkmark"></span>\n              <span class="zadark-radio__label">\n                <span>Sáng</span>\n                <span class="zadark-switch__hotkeys">\n                  &nbsp;<span class="zadark-hotkeys" data-keys-win="Ctrl+D" data-keys-mac="⌘D"></span>\n                </span>\n              </span>\n            </label>\n\n            <label class="zadark-radio">\n              <input type="radio" name="theme" value="dark" class="zadark-radio__input">\n              <span class="zadark-radio__checkmark"></span>\n              <span class="zadark-radio__label">\n                <span>Tối</span>\n                <span class="zadark-switch__hotkeys">\n                  &nbsp;<span class="zadark-hotkeys" data-keys-win="Ctrl+D" data-keys-mac="⌘D"></span>\n                </span>\n              </span>\n            </label>\n\n            <label class="zadark-radio">\n              <input type="radio" name="theme" value="auto" class="zadark-radio__input">\n              <span class="zadark-radio__checkmark"></span>\n              <span class="zadark-radio__label">\n                <span>Hệ thống</span>\n              </span>\n            </label>\n          </div>\n\n          <div class="font-settings font-settings--border-default">\n            <label class="font-settings__label">\n              Phông chữ từ <a href="https://zadark.com/blog/use-google-fonts" target="_blank">Google Fonts</a>\n            </label>\n\n            <input id="js-input-font-family" class="zadark-input" placeholder="Mặc định">\n          </div>\n\n          <div class="font-settings font-settings--hotkeys">\n            <label class="select-font__label">Cỡ chữ của tin nhắn</label>\n\n            <span class="font-settings__hotkeys">\n              <span class="zadark-hotkeys" data-keys-win="Ctrl+9 Ctrl+0" data-keys-mac="⌘9 ⌘0"></span>\n            </span>\n\n            <select id="js-select-font-size" class="zadark-select">\n              <option value="small">90%</option>\n              <option value="medium">100%</option>\n              <option value="big">110%</option>\n              <option value="very-big">125%</option>\n            </select>\n          </div>\n\n          <div class="font-settings">\n            <label class="font-settings__label" style="flex: 1;">\n              Dịch tin nhắn\n              <i class="zadark-icon zadark-icon--question" data-tippy-content='<p>Bạn di chuyển chuột vào đoạn tin nhắn và chọn biểu tượng <i class="zadark-icon zadark-icon--translate" style="position: relative; top: 3px; font-size: 18px;"></i> để dịch tin nhắn.</p><p>Bạn có 20 lượt dịch tin nhắn mỗi ngày.</p>'></i>\n            </label>\n\n            <select id="js-select-translate-target" class="zadark-select"></select>\n          </div>\n\n          <div class="font-settings">\n            <label class="font-settings__label" style="flex: 1;">\n              Hình nền cuộc trò chuyện\n              <i class="zadark-icon zadark-icon--question" data-tippy-content='<p>Bạn chọn một cuộc trò chuyện bất kỳ để thêm hình nền.</p><p>Hình nền được lưu trên máy tính của bạn, không đồng bộ với Zalo Mobile và mất khi bạn xoá Zalo PC.</p>'></i>\n            </label>\n\n            <input type="file" id="js-input-thread-chat-bg" class="zadark-input-file" accept=".jpg, .jpeg, .png" />\n            <label for="js-input-thread-chat-bg"></label>\n\n            <button id="js-button-del-thread-chat-bg" class="btn-del" style="margin-left: 12px;">Xoá</button>\n          </div>\n        </div>\n      </div>\n\n      <div class="zadark-panel">\n        <div class="zadark-panel__body">\n          <div class="zadark-switch__list">\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-latest-message">\n                Ẩn <strong>Tin nhắn gần nhất</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Để xem nội dung tin nhắn, bạn di chuột vào<br/>"<strong>Tên cuộc trò chuyện</strong>" cần xem'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+1" data-keys-mac="⌘1"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-latest-message">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch zadark-switch--border-default">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-thread-chat-message">\n                Ẩn <strong>Tin nhắn</strong> trong cuộc trò chuyện\n                <i class="zadark-icon zadark-icon--play-circle" data-zdk-intro="hideThreadChatMessage" data-tippy-content="Nhấn vào để xem hướng dẫn"></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+2" data-keys-mac="⌘2"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-thread-chat-message">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-conv-avatar">\n                Ẩn <strong>Ảnh đại diện</strong> cuộc trò chuyện\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Để xem Ảnh đại diện, bạn di chuyển chuột vào<br/>"<strong>Ảnh đại diện</strong>" cần xem'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+3" data-keys-mac="⌘3"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-conv-avatar">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch zadark-switch--border-default">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-conv-name">\n                Ẩn <strong>Tên</strong> cuộc trò chuyện\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Để xem Tên cuộc trò chuyện, bạn di chuyển chuột vào "<strong>Tên cuộc trò chuyện</strong>" cần xem'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+7" data-keys-mac="⌘7"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-conv-name">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-block-typing">\n                Ẩn trạng thái <strong>Đang soạn tin</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Người khác sẽ không thấy trạng thái <strong>Đang soạn tin</strong> của bạn, nhưng bạn vẫn thấy trạng thái của họ. Đây là điểm khác biệt giữa cài đặt từ ZaDark và Zalo.'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+4" data-keys-mac="⌘4"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-block-typing">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-block-delivered">\n                Ẩn trạng thái <strong>Đã nhận</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Người khác sẽ không thấy trạng thái <strong>Đã nhận</strong> tin nhắn của bạn, nhưng bạn vẫn thấy trạng thái của họ. Đây là điểm khác biệt giữa cài đặt từ ZaDark và Zalo.'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+5" data-keys-mac="⌘5"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-block-delivered">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label" for="js-switch-block-seen">\n                Ẩn trạng thái <strong>Đã xem</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='<p>Người khác sẽ không thấy trạng thái <strong>Đã xem</strong> tin nhắn của bạn, nhưng bạn vẫn thấy trạng thái của họ. Đây là điểm khác biệt giữa cài đặt từ ZaDark và Zalo.</p><p>Tuy nhiên, trạng thái của các tin nhắn bạn đã xem trên Zalo Web sẽ <strong>không được đồng bộ</strong> với máy chủ Zalo, bạn cần phải xem lại tin nhắn trên Zalo Mobile để đồng bộ.</p>'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+6" data-keys-mac="⌘6"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-block-seen">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="zadark-panel">\n        <div class="zadark-panel__body">\n          <div class="zadark-switch__list">\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-use-hotkeys">\n                Sử dụng phím tắt\n              </label>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-use-hotkeys">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  \n          \n    <div class="zadark-popup__footer">\n      <a href="https://quaric.com" target="_blank" title="ZaDark by Quaric" class="zadark-publisher">\n        <span class="zadark-publisher__by">ZaDark by</span>\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 64" fill="none" class="zadark-publisher__lockup"><path fill="currentColor" fill-rule="evenodd" d="M264 64V54h-12.998A24.892 24.892 0 0 0 256 39V25c0-13.807-11.193-25-25-25h-46c-13.807 0-25 11.193-25 25v14c0 13.807 11.193 25 25 25h79Zm-79-54c-8.284 0-15 6.716-15 15v14c0 8.284 6.716 15 15 15h46.019C239.294 53.99 246 47.278 246 39V25c0-8.284-6.716-15-15-15h-46Z" clip-rule="evenodd"/><path fill="currentColor" d="M282 0v39c0 8.284 6.716 15 15 15h37V0h10v64h-47c-13.807 0-25-11.193-25-25V0h10Z"/><path fill="currentColor" fill-rule="evenodd" d="M415 0h-39v10h39c7.948 0 14.452 6.182 14.967 14H380c-11.046 0-20 8.954-20 20s8.954 20 20 20h60V25c0-13.807-11.193-25-25-25Zm-35 34h50v20h-50c-5.523 0-10-4.477-10-10s4.477-10 10-10Z" clip-rule="evenodd"/><path fill="currentColor" d="M456 25c0-13.807 11.193-25 25-25h45v10h-45c-8.284 0-15 6.716-15 15v39h-10V25ZM544 64V0h-10v64h10ZM570 25c0-8.284 6.716-15 15-15h55V0h-55c-13.807 0-25 11.193-25 25v14c0 13.807 11.193 25 25 25h55V54h-55c-8.284 0-15-6.716-15-15V25ZM72 0l44.313 15.783c15.583 5.172 15.583 27.263 0 32.434L72 64V53.338l41.161-14.66c6.416-2.13 6.416-11.226 0-13.356L78.518 12.75 56 64 11.687 48.218c-15.583-5.172-15.583-27.263 0-32.435L56 0v10.662l-41.161 14.66c-6.416 2.13-6.416 11.226 0 13.356L49.482 51.25 72 0Z"/></svg>\n      </a>\n    </div>\n  \n\n          <button id="js-btn-scroll" data-tippy-content="Cuộn xuống">\n            <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z" fill="currentColor" /></svg>\n          </button>\n        </div>\n      </div>\n    </div>\n  `,b=(t=!0)=>{if(!t)return void hotkeys.unbind();hotkeys.filter=function(t){const a=t.target||t.srcElement,e=a.tagName;let n=!0;return"INPUT"!==e&&"TEXTAREA"!==e&&"SELECT"!==e||a.readOnly||(n=!1),n};const a=["command+1","command+2","command+3","command+7","command+4","command+5","command+6","command+0","command+9","command+d","ctrl+1","ctrl+2","ctrl+3","ctrl+7","ctrl+4","ctrl+5","ctrl+6","ctrl+0","ctrl+9","ctrl+d"].join(",");hotkeys(a,function(t,a){t.preventDefault();const e=c.getEnabledHideLatestMessage(),n=c.getEnabledHideConvAvatar(),s=c.getEnabledHideConvName(),i=c.getEnabledHideThreadChatMessage(),o=c.getBlockSettings();switch(a.key){case"command+1":case"ctrl+1":return r.setSwitch("#js-switch-hide-latest-message",!e),void r.updateHideLatestMessage(!e);case"command+2":case"ctrl+2":return r.setSwitch("#js-switch-hide-thread-chat-message",!i),void r.updateHideThreadChatMessage(!i);case"command+3":case"ctrl+3":return r.setSwitch("#js-switch-hide-conv-avatar",!n),void r.updateHideConvAvatar(!n);case"command+7":case"ctrl+7":return r.setSwitch("#js-switch-hide-conv-name",!s),void r.updateHideConvName(!s);case"command+4":case"ctrl+4":return r.setSwitch(l,!o.block_typing),void m("block_typing").bind($(l))();case"command+5":case"ctrl+5":return r.setSwitch(h,!o.block_delivered),void m("block_delivered").bind($(h))();case"command+6":case"ctrl+6":return r.setSwitch(d,!o.block_seen),void m("block_seen").bind($(d))();case"command+0":case"ctrl+0":return void u(1);case"command+9":case"ctrl+9":return void u(-1);case"command+d":case"ctrl+d":(()=>{const t=c.getTheme(),a=["light","dark"],e=a.indexOf(t)+1,n=a[e]||a[0];p(n),r.updateTheme(n)})()}})},_=()=>{const t=c.getTheme();p(t);const a=c.getFontFamily();r.setSelect("#js-input-font-family",a);const e=c.getFontSize();r.setSelect("#js-select-font-size",e);const n=c.getEnabledHideLatestMessage();r.setSwitch("#js-switch-hide-latest-message",n);const s=c.getEnabledHideConvAvatar();r.setSwitch("#js-switch-hide-conv-avatar",s);const i=c.getEnabledHideConvName();r.setSwitch("#js-switch-hide-conv-name",i);const o=c.getEnabledHideThreadChatMessage();if(r.setSwitch("#js-switch-hide-thread-chat-message",o),g){const t=c.getBlockSettings();r.setSwitch(l,t.block_typing),r.setSwitch(h,t.block_delivered),r.setSwitch(d,t.block_seen)}else[l,d,h].forEach(t=>{$(t).parent().parent().addClass("zadark-switch--disabled")}),tippy(".js-switch-block",{theme:"zadark",allowHTML:!0,content:`<p>Vì Zalo nâng cấp mã nguồn, nên chức năng này tạm thời không khả dụng trên <strong>Zalo PC ${c.getZaloAppVersion()}</strong>.</p><p>ZaDark sẽ cập nhật trong thời gian tới.</p>`});const k=c.getUseHotkeys();r.setSwitch("#js-switch-use-hotkeys",k)},y=()=>{const t=$("#js-zadark-popup__scrollable"),a=t.scrollTop();!(t.prop("scrollHeight")>t.innerHeight())||a>=24?$("#js-btn-scroll").fadeOut(150):$("#js-btn-scroll").fadeIn(150)},w=(t,a,e=!0)=>{e?(t.classList.add("selected"),a.setAttribute("data-visible","")):(t.classList.remove("selected"),a.removeAttribute("data-visible"))},z=()=>{const[t]=document.querySelectorAll(".nav__tabs__bottom");if(!t)return;t.insertAdjacentHTML("afterbegin",'\n    <div id="div_Main_TabZaDark" class="clickable leftbar-tab flx flx-col flx-al-c flx-center rel" data-id="div_Main_TabZaDark">\n      <i class="zadark-icon zadark-icon--zadark"></i>\n      <div class="lb-tab-title truncate">ZaDark</div>\n    </div>\n  '),document.body.insertAdjacentHTML("beforeend",v),$('#js-radio-input-theme input:radio[name="theme"]').on("change",function(){const t=$(this).val();r.updateTheme(t)}),$("#js-input-font-family").keypress(k),$("#js-select-font-size").on("change",function(){const t=$(this).val();r.updateFontSize(t)}),$("#js-select-translate-target").on("change",function(){const t=$(this).val();r.updateTranslateTarget(t),$(document).disableTranslateMessage(),"none"!==t&&$(document).enableTranslateMessage(t)}),$("#js-input-thread-chat-bg").on("click",function(t){r.getCurrentConvId()||(t.preventDefault(),r.showToast("Chọn một cuộc trò chuyện để đặt hình nền"))}),$("#js-input-thread-chat-bg").on("change",function(){const t=this.files[0];if(t)if(t.size>4194304)r.showToast("Dung lượng ảnh tối đa là 4MB",{className:"toastify--error",duration:3e3});else try{r.updateThreadChatBg(t),$(this).addClass("zadark-input-file--loaded")}catch(t){r.showToast(`Lỗi khi tải ảnh: ${t.message}`)}}),$("#js-button-del-thread-chat-bg").on("click",function(){r.updateThreadChatBg(""),$("#js-input-thread-chat-bg").removeClass("zadark-input-file--loaded")}),$("#js-switch-hide-latest-message").on("change",function(){const t=$(this).is(":checked");r.updateHideLatestMessage(t)}),$("#js-switch-hide-conv-avatar").on("change",function(){const t=$(this).is(":checked");r.updateHideConvAvatar(t)}),$("#js-switch-hide-conv-name").on("change",function(){const t=$(this).is(":checked");r.updateHideConvName(t)}),$("#js-switch-hide-thread-chat-message").on("change",function(){const t=$(this).is(":checked");r.updateHideThreadChatMessage(t)}),$(l).on("change",m("block_typing")),$(d).on("change",m("block_seen")),$(h).on("change",m("block_delivered")),$("#js-switch-use-hotkeys").on("change",function(){const t=$(this).is(":checked");r.updateUseHotkeys(t),b(t)});const a=document.querySelector("#js-zadark-popup"),e=document.getElementById("div_Main_TabZaDark");e.addEventListener("click",((t,a)=>()=>{_(),r.updateKnownVersionState(t),w(t,a,!0),y()})(e,a));["click","contextmenu"].forEach(t=>{window.addEventListener(t,((t,a)=>e=>{null!==a.getAttribute("data-visible")&&!a.contains(e.target)&&!t.contains(e.target)&&w(t,a,!1)})(e,a),!0)}),_(),(async()=>{const t=c.getUseHotkeys();b(t)})(),(t=>{`${c.getKnownVersion()}`!==`${$("html").data("zadark-version")}`&&t.classList.add("zadark-known-version")})(e),y(),$("#js-zadark-popup__scrollable").on("scroll",ZaDarkShared.debounce(y,150)),$(window).on("resize",ZaDarkShared.debounce(y,250)),$("#js-btn-scroll").on("click",t=>{t.stopPropagation(),t.preventDefault(),$("#js-zadark-popup__scrollable").animate({scrollTop:$("#js-zadark-popup__scrollable").height()},1e3)}),(()=>{const t=c.getTranslateTarget();$("#js-select-translate-target").setLanguagesOptions(t),$(document).enableTranslateMessage(t)})(),tippy("[data-tippy-content]",{theme:"zadark",allowHTML:!0}),tippy("#div_Main_TabZaDark",{theme:"zadark",allowHTML:!0,content:`Cài đặt ZaDark ${r.getZaDarkVersion()}`,placement:"right"}),tippy("#js-input-font-family",{theme:"zadark",allowHTML:!0,content:"<p>Nhập tên phông chữ từ <strong>Google Fonts</strong><br>(Lưu ý kí tự in hoa, khoảng cách).</p><p>Bỏ trống nếu dùng phông mặc định.</p><p>Nhấn <strong>Enter</strong> để áp dụng.</p>",trigger:"focus"}),tippy("#js-select-translate-target",{theme:"zadark",allowHTML:!0,content:"Bạn muốn dịch sang ngôn ngữ nào?"}),r.migrateData(),$("[data-zdk-intro]").on("click",function(t){t.preventDefault(),t.stopPropagation();const n=$(this).data("zdk-intro"),s=$("#chatViewContainer").length>0;if(["hideThreadChatMessage"].includes(n)&&!s)return void r.showToast("Chọn một cuộc trò chuyện để xem hướng dẫn");w(e,a,!1);const i={onExit:()=>w(e,a,!0),onComplete:()=>w(e,a,!0)};"hideThreadChatMessage"===n&&r.showIntroHideThreadChatMessage(i)});const n=document.createElement("script");n.src="zadark-zconv.min.js",n.onload=function(){this.remove()},(document.head||document.documentElement).append(n),document.addEventListener("@ZaDark:CONV_ID_CHANGE",function(){(async()=>{const t=r.getThreadChatBgSettingKey();if(!t)return void r.showToast("Không thể tải hình nền vì không xác định được cuộc trò chuyện hiện tại",{className:"toastify--error",duration:3e3});let a=!0;if(!document.getElementById(t)){const e=await c.getThreadChatBg(t);a=!!e,r.refreshThreadChatBg(e)}a?$("#js-input-thread-chat-bg").addClass("zadark-input-file--loaded"):$("#js-input-thread-chat-bg").removeClass("zadark-input-file--loaded")})()})},f=new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{"app-page"===t.id&&(z(),f.disconnect())})})});f.observe(document.querySelector("#app"),{subtree:!1,childList:!0})}();